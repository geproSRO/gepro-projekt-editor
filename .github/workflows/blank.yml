name: Notify team on new issue
on:
  issues:
    types: [opened]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send email via SendGrid
        run: |
          curl -X POST https://api.eu.sendgrid.com/v3/mail/send \
          -H "Authorization: Bearer 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" \
          -H "Content-Type: application/json" \
          -d '{
            "personalizations": [
              {
                "to": [
                  {"email": "robert.sekot@gepro.cz", "name": "Robert Sekot"},
                  {"email": "alena.cechova@gepro.cz", "name": "Alena ÄŒechovÃ¡"}
                ]
              }
            ],
            "from": {"email": "github-bot@gepro.cz", "name": "GitHub Bot"},
            "subject": "NovÃ© issue v ${{ github.repository }}",
            "content": [
              {
                "type": "text/plain",
                "value": "ðŸ†• NovÃ© issue vytvoÅ™eno:\n\nRepo: ${{ github.repository }}\nÄŒÃ­slo: #${{ github.event.issue.number }}\nAutor: ${{ github.actor }}\nTitulek: ${{ github.event.issue.title }}\nURL: ${{ github.event.issue.html_url }}"
              }
            ]
          }'
